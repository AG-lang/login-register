# React æ ¸å¿ƒæ¦‚å¿µæ•™å­¦

ç°åœ¨æ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
npm run dev

é¡¹ç›®å°†åœ¨ [http://localhost:10000](http://localhost:10000) å¯åŠ¨ã€‚

---

ğŸ“š React æ ¸å¿ƒæ¦‚å¿µæ·±åº¦è®²è§£

## 1. React Hooks çš„ä½¿ç”¨

useState Hook

ä½œç”¨ (What): useState æ˜¯ React æä¾›çš„ä¸€ä¸ª Hookï¼Œç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ çŠ¶æ€ç®¡ç†åŠŸèƒ½ã€‚

åŸç†å’Œä¸ºä»€ä¹ˆè¿™ä¹ˆåš (Why & How):

åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­ï¼Œæ¯æ¬¡ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå‡½æ•°éƒ½ä¼šé‡æ–°æ‰§è¡Œã€‚è¿™æ„å‘³ç€å‡½æ•°å†…éƒ¨çš„æ™®é€šå˜é‡ä¼šè¢«é‡ç½®ã€‚ä½†æ˜¯æˆ‘ä»¬ç»å¸¸éœ€è¦åœ¨
ç»„ä»¶çš„å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒæŸäº›æ•°æ®ï¼Œè¿™å°±æ˜¯ useState å­˜åœ¨çš„æ„ä¹‰ã€‚

```javascript
const [formData, setFormData] = useState({
  username: "",
  password: "",
});
```

æ·±åº¦è§£æ:

- useState è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ä¸¤ä¸ªå…ƒç´ ï¼šå½“å‰çŠ¶æ€å€¼å’Œæ›´æ–°çŠ¶æ€çš„å‡½æ•°
- React åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€é˜Ÿåˆ—ï¼Œæ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€
- å½“è°ƒç”¨ setFormData æ—¶ï¼ŒReact ä¼šï¼š
  a. å°†æ–°çŠ¶æ€åŠ å…¥æ›´æ–°é˜Ÿåˆ—
  b. è§¦å‘ç»„ä»¶é‡æ–°æ¸²æŸ“
  c. åœ¨ä¸‹æ¬¡æ¸²æŸ“æ—¶è¿”å›æ–°çš„çŠ¶æ€å€¼

ä¸ºä»€ä¹ˆä½¿ç”¨æ•°ç»„è§£æ„:

```javascript
// React è®¾è®¡æˆæ•°ç»„è€Œä¸æ˜¯å¯¹è±¡ï¼Œæ˜¯ä¸ºäº†è®©å¼€å‘è€…å¯ä»¥è‡ªç”±å‘½å
const [name, setName] = useState(""); // å¯ä»¥å« name
const [age, setAge] = useState(0); // å¯ä»¥å« age
```

useEffect Hook

ä½œç”¨ (What): useEffect ç”¨äºåœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œï¼Œå¦‚æ•°æ®è·å–ã€DOM æ“ä½œã€è®¢é˜…ç­‰ã€‚

åŸç†å’Œä¸ºä»€ä¹ˆè¿™ä¹ˆåš (Why & How):

```javascript
useEffect(() => {
  const user = getCurrentUser();
  setCurrentUser(user);
}, []); // ç©ºä¾èµ–æ•°ç»„
```

ç”Ÿå‘½å‘¨æœŸå¯¹åº”å…³ç³»:

- useEffect(() => {}) - æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œï¼ˆç±»ä¼¼ componentDidUpdateï¼‰
- useEffect(() => {}, []) - åªåœ¨æŒ‚è½½åæ‰§è¡Œä¸€æ¬¡ï¼ˆç±»ä¼¼ componentDidMountï¼‰
- useEffect(() => {}, [dep]) - ä¾èµ–å˜åŒ–æ—¶æ‰§è¡Œ
- useEffect(() => { return cleanup }, []) - è¿”å›æ¸…ç†å‡½æ•°ï¼ˆç±»ä¼¼ componentWillUnmountï¼‰

ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–æ•°ç»„:

```javascript
// ä¸å¥½çš„ä¾‹å­ - ä¼šæ— é™å¾ªç¯
useEffect(() => {
  setCount(count + 1); // æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè§¦å‘çŠ¶æ€æ›´æ–°ï¼Œå¯¼è‡´æ— é™å¾ªç¯
});

// æ­£ç¡®çš„ä¾‹å­
useEffect(() => {
  // åªåœ¨ç»„ä»¶æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡
  initializeDefaultUser();
}, []); // ç©ºä¾èµ–æ•°ç»„æ˜¯å…³é”®
```

useNavigate Hook

ä½œç”¨ (What): useNavigate æ˜¯ React Router æä¾›çš„ Hookï¼Œç”¨äºç¨‹åºåŒ–å¯¼èˆªã€‚

åŸç†å’Œä¸ºä»€ä¹ˆè¿™ä¹ˆåš (Why & How):

```javascript
const navigate = useNavigate();

const handleLogin = () => {
  // ç™»å½•æˆåŠŸåè·³è½¬
  navigate("/", { replace: true });
};
```

ä¸ºä»€ä¹ˆç”¨ replace: true:

```javascript
navigate("/home"); // æ·»åŠ åˆ°å†å²è®°å½•ï¼Œç”¨æˆ·å¯ä»¥åé€€
navigate("/home", { replace: true }); // æ›¿æ¢å½“å‰è®°å½•ï¼Œç”¨æˆ·æ— æ³•åé€€åˆ°ç™»å½•é¡µ
```

è¿™åœ¨ç™»å½•åœºæ™¯ä¸­å¾ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·ç™»å½•åè¿˜èƒ½é€šè¿‡åé€€æŒ‰é’®å›åˆ°ç™»å½•é¡µé¢ã€‚

## 2. å—æ§ç»„ä»¶ (Controlled Components)

ä½œç”¨ (What): å—æ§ç»„ä»¶æ˜¯æŒ‡è¡¨å•å…ƒç´ çš„å€¼ç”± React çš„ state æ§åˆ¶çš„ç»„ä»¶ã€‚

åŸç†å’Œä¸ºä»€ä¹ˆè¿™ä¹ˆåš (Why & How):

```javascript
const [formData, setFormData] = useState({
  username: "",
  password: "",
});

const handleInputChange = (e) => {
  const { name, value } = e.target;
  setFormData((prev) => ({
    ...prev,
    [name]: value,
  }));
};

return (
  <input
    name="username"
    value={formData.username} // å…³é”®ï¼šå€¼æ¥è‡ª state
    onChange={handleInputChange} // å…³é”®ï¼šå˜åŒ–æ—¶æ›´æ–° state
  />
);
```

å—æ§ vs éå—æ§ç»„ä»¶:

```javascript
// å—æ§ç»„ä»¶ - React ç®¡ç†çŠ¶æ€
<input value={state} onChange={handleChange} />

// éå—æ§ç»„ä»¶ - DOM ç®¡ç†çŠ¶æ€
<input ref={inputRef} />
```

ä¸ºä»€ä¹ˆæ¨èå—æ§ç»„ä»¶:

1. æ•°æ®ä¸€è‡´æ€§: çŠ¶æ€çš„å”¯ä¸€æ•°æ®æºæ˜¯ React state
2. å®æ—¶éªŒè¯: å¯ä»¥åœ¨è¾“å…¥æ—¶ç«‹å³éªŒè¯
3. åŠ¨æ€äº¤äº’: å¯ä»¥æ ¹æ®è¾“å…¥åŠ¨æ€æ”¹å˜ UI
4. è¡¨å•é‡ç½®: å¯ä»¥è½»æ¾é‡ç½®è¡¨å•çŠ¶æ€

æ·±å…¥ç†è§£æ•°æ®æµ:
ç”¨æˆ·è¾“å…¥ â†’ onChange äº‹ä»¶ â†’ æ›´æ–° state â†’ é‡æ–°æ¸²æŸ“ â†’ input æ˜¾ç¤ºæ–°å€¼

## 3. è·¯ç”±é…ç½®

createBrowserRouter

ä½œç”¨ (What): createBrowserRouter æ˜¯ React Router v6 æ¨èçš„è·¯ç”±é…ç½®æ–¹å¼ï¼Œåˆ›å»ºä¸€ä¸ªåŸºäºæµè§ˆå™¨å†å²è®°å½•çš„è·¯ç”±å™¨ã€‚

åŸç†å’Œä¸ºä»€ä¹ˆè¿™ä¹ˆåš (Why & How):

```javascript
const router = createBrowserRouter([
  {
    path: "/",
    element: (
      <PrivateRoute>
        <HomePage />
      </PrivateRoute>
    ),
  },
  {
    path: "/login",
    element: <LoginPage />,
  },
]);
```

ä¸ºä»€ä¹ˆé€‰æ‹© createBrowserRouter:

1. å£°æ˜å¼é…ç½®: è·¯ç”±é…ç½®æ›´æ¸…æ™°ã€é›†ä¸­
2. æ•°æ®åŠ è½½: æ”¯æŒè·¯ç”±çº§åˆ«çš„æ•°æ®é¢„åŠ è½½
3. é”™è¯¯å¤„ç†: æ›´å¥½çš„é”™è¯¯è¾¹ç•Œå¤„ç†
4. æ€§èƒ½ä¼˜åŒ–: æ”¯æŒä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½

RouterProvider å’Œä¸Šä¸‹æ–‡

```javascript
function App() {
  return <RouterProvider router={router} />;
}
```

å†…éƒ¨æœºåˆ¶:
RouterProvider â†’ React Context â†’ æ‰€æœ‰å­ç»„ä»¶éƒ½èƒ½è®¿é—®è·¯ç”±ä¿¡æ¯

Link ç»„ä»¶

ä½œç”¨ (What): `<Link>`ç»„ä»¶ç”¨äºåˆ›å»ºå¯¼èˆªé“¾æ¥ï¼Œä¸ä¼šè§¦å‘é¡µé¢åˆ·æ–°ã€‚

```jsx
[ç«‹å³æ³¨å†Œ](/register)
```

ä¸ºä»€ä¹ˆä¸ç”¨æ™®é€šçš„ `<a>` æ ‡ç­¾:

```html
// æ™®é€šé“¾æ¥ - ä¼šåˆ·æ–°é¡µé¢ï¼Œä¸¢å¤±åº”ç”¨çŠ¶æ€
<a href="/register">æ³¨å†Œ</a>

// React Router Link - å®¢æˆ·ç«¯å¯¼èˆªï¼Œä¿æŒåº”ç”¨çŠ¶æ€
<Link to="/register">æ³¨å†Œ</Link>
```

## 4. å—ä¿æŠ¤çš„è·¯ç”± (Protected Route)

ä½œç”¨ (What): å—ä¿æŠ¤çš„è·¯ç”±æ˜¯ä¸€ç§æ¨¡å¼ï¼Œç”¨äºé™åˆ¶åªæœ‰æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼ˆå¦‚å·²ç™»å½•ï¼‰çš„ç”¨æˆ·æ‰èƒ½è®¿é—®æŸäº›é¡µé¢ã€‚

å®ç°åŸç†å’Œè®¾è®¡æ€è·¯:

```javascript
function PrivateRoute({ children }) {
  const token = localStorage.getItem("token");
  return token ? children : <Navigate to="/login" replace />;
}
```

æ·±åº¦è§£æ:

1. æ¡ä»¶æ¸²æŸ“: æ ¹æ®è®¤è¯çŠ¶æ€å†³å®šæ¸²æŸ“ä»€ä¹ˆ
2. è‡ªåŠ¨é‡å®šå‘: æœªè®¤è¯ç”¨æˆ·è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
3. ç»„ä»¶ç»„åˆ: ä½¿ç”¨é«˜é˜¶ç»„ä»¶æ¨¡å¼åŒ…è£…éœ€è¦ä¿æŠ¤çš„ç»„ä»¶

å®Œæ•´çš„è®¤è¯æµç¨‹:
è®¿é—®å—ä¿æŠ¤é¡µé¢ â†’ æ£€æŸ¥è®¤è¯çŠ¶æ€ â†’ å·²è®¤è¯ï¼Ÿæ¸²æŸ“é¡µé¢ : é‡å®šå‘ç™»å½•
â†“
ç™»å½•æˆåŠŸ â†’ å­˜å‚¨ token â†’ é‡å®šå‘åˆ°ç›®æ ‡é¡µé¢

é«˜çº§å®ç°è€ƒè™‘:

```javascript
function PrivateRoute({ children, requiredRole }) {
  const token = localStorage.getItem("token");
  const user = getCurrentUser();

  if (!token) return <Navigate to="/login" />;
  if (requiredRole && user.role !== requiredRole) {
    return <Navigate to="/forbidden" />;
  }

  return children;
}
```

## 5. ä½¿ç”¨ localStorage æ¨¡æ‹Ÿè®¤è¯

ä½œç”¨ (What): localStorage æ˜¯æµè§ˆå™¨æä¾›çš„ Web Storage APIï¼Œå¯ä»¥åœ¨ç”¨æˆ·çš„æœ¬åœ°å­˜å‚¨æ•°æ®ã€‚

ä¸ºä»€ä¹ˆåœ¨å‰ç«¯é¡¹ç›®ä¸­å¾ˆæ–¹ä¾¿:

1. æŒä¹…æ€§: æ•°æ®åœ¨æµè§ˆå™¨å…³é—­åä»ç„¶å­˜åœ¨
2. ç®€å•æ€§: API ç®€å•ï¼Œæ˜“äºä½¿ç”¨
3. æ— éœ€æœåŠ¡å™¨: é€‚åˆå‰ç«¯åŸå‹å’Œå­¦ä¹ é¡¹ç›®
4. åŒæºè®¿é—®: åªæœ‰åŒåŸŸçš„é¡µé¢å¯ä»¥è®¿é—®

å®é™…ä½¿ç”¨:

```javascript
// å­˜å‚¨ç”¨æˆ·æ•°æ®
localStorage.setItem("users", JSON.stringify(users));

// å­˜å‚¨è®¤è¯ token
localStorage.setItem("token", "user_token_123");

// è¯»å–æ•°æ®
const users = JSON.parse(localStorage.getItem("users") || "[]");
const token = localStorage.getItem("token");

// æ¸…é™¤æ•°æ®
localStorage.removeItem("token");
localStorage.clear(); // æ¸…é™¤æ‰€æœ‰æ•°æ®
```

å±€é™æ€§å’Œæ³¨æ„äº‹é¡¹:

1. å®‰å…¨æ€§é—®é¢˜:

```javascript
// âŒ ä¸å®‰å…¨ï¼šæ•æ„Ÿæ•°æ®æ˜æ–‡å­˜å‚¨
localStorage.setItem("password", "user123");

// âœ… ç›¸å¯¹å®‰å…¨ï¼šåªå­˜å‚¨ tokenï¼Œå¯†ç åœ¨æœåŠ¡ç«¯éªŒè¯
localStorage.setItem("token", "jwt_token_here");
```

1. å­˜å‚¨é™åˆ¶:

   - é€šå¸¸é™åˆ¶ä¸º 5-10MB
   - åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®

2. æµè§ˆå™¨å…¼å®¹æ€§:

   - ç°ä»£æµè§ˆå™¨éƒ½æ”¯æŒ
   - éšç§æ¨¡å¼å¯èƒ½ç¦ç”¨

3. æ•°æ®æŒä¹…æ€§:

```javascript
// localStorage - æ°¸ä¹…å­˜å‚¨
localStorage.setItem("data", "permanent");

// sessionStorage - ä¼šè¯å­˜å‚¨
sessionStorage.setItem("data", "temporary");
```

çœŸå®é¡¹ç›®ä¸­çš„æœ€ä½³å®è·µ:

```javascript
// 1. ä½¿ç”¨ JWT token
const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...";
localStorage.setItem("authToken", token);

// 2. è®¾ç½®è¿‡æœŸæ—¶é—´
const tokenData = {
  token: "jwt_token",
  expiresAt: Date.now() + 24 * 60 * 60 * 1000, // 24 å°æ—¶åè¿‡æœŸ
};
localStorage.setItem("authData", JSON.stringify(tokenData));

// 3. éªŒè¯ token æœ‰æ•ˆæ€§
function isTokenValid() {
  const authData = JSON.parse(localStorage.getItem("authData") || "{}");
  return authData.token && Date.now() < authData.expiresAt;
}
```

æ›¿ä»£æ–¹æ¡ˆ:

1. Cookie: é€‚åˆéœ€è¦æœåŠ¡ç«¯è®¿é—®çš„åœºæ™¯
2. SessionStorage: é€‚åˆä¼šè¯çº§åˆ«çš„å­˜å‚¨
3. IndexedDB: é€‚åˆå¤§é‡æ•°æ®å­˜å‚¨
4. æœåŠ¡ç«¯ Session: æœ€å®‰å…¨çš„æ–¹æ¡ˆ

---

ğŸ¯ å­¦ä¹ æ€»ç»“

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæ‚¨å­¦ä¼šäº†ï¼š

1. React Hooks: ç†è§£äº† useStateã€useEffectã€useNavigate çš„å·¥ä½œåŸç†
2. å—æ§ç»„ä»¶: æŒæ¡äº† React ä¸­è¡¨å•å¤„ç†çš„æœ€ä½³å®è·µ
3. è·¯ç”±ç³»ç»Ÿ: å­¦ä¼šäº†ä½¿ç”¨ React Router æ„å»ºå•é¡µåº”ç”¨
4. è®¤è¯æœºåˆ¶: å®ç°äº†åŸºæœ¬çš„ç”¨æˆ·è®¤è¯å’Œè·¯ç”±ä¿æŠ¤
5. çŠ¶æ€ç®¡ç†: ç†è§£äº†ç»„ä»¶çŠ¶æ€çš„ç®¡ç†å’Œæ•°æ®æµ

è¿™äº›æ˜¯ React å¼€å‘çš„æ ¸å¿ƒæ¦‚å¿µï¼Œä¸ºæ‚¨åç»­å­¦ä¹ æ›´å¤æ‚çš„ React åº”ç”¨æ‰“ä¸‹äº†åšå®çš„åŸºç¡€ï¼

â— Update Todos
â¿ â˜’ åˆå§‹åŒ– Vite React é¡¹ç›®å¹¶å®‰è£…ä¾èµ–
â˜’ åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„å’ŒåŸºç¡€æ–‡ä»¶
â˜’ å®ç° PrivateRoute ä¿æŠ¤è·¯ç”±ç»„ä»¶
â˜’ åˆ›å»ºæ³¨å†Œé¡µé¢ç»„ä»¶
â˜’ åˆ›å»ºç™»å½•é¡µé¢ç»„ä»¶
â˜’ åˆ›å»ºé¦–é¡µç»„ä»¶
â˜’ é…ç½®è·¯ç”±å’Œåº”ç”¨å…¥å£
â˜’ ç¼–å†™æ ¸å¿ƒæ¦‚å¿µæ•™å­¦æ–‡æ¡£

â— ğŸš€ å¯åŠ¨æŒ‡å—

ç°åœ¨æ‚¨å¯ä»¥å¯åŠ¨é¡¹ç›®äº†ï¼š

```bash
npm run dev
```

é¡¹ç›®å°†åœ¨ [http://localhost:10000](http://localhost:10000) å¯åŠ¨ã€‚

æµ‹è¯•æ­¥éª¤:

1. è®¿é—® [http://localhost:10000](http://localhost:10000) - ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µ
2. ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•ï¼šç”¨æˆ·å adminï¼Œå¯†ç  123456
3. æˆ–è€…ç‚¹å‡»"ç«‹å³æ³¨å†Œ"åˆ›å»ºæ–°è´¦å·
4. ç™»å½•æˆåŠŸåä¼šè·³è½¬åˆ°å—ä¿æŠ¤çš„é¦–é¡µ
5. ç‚¹å‡»"å®‰å…¨ç™»å‡º"å¯ä»¥è¿”å›ç™»å½•é¡µ

é¡¹ç›®æ–‡ä»¶ç»“æ„:

```text
/src
â”œâ”€â”€ components/
â”‚   â””â”€â”€ PrivateRoute.jsx # ä¿æŠ¤è·¯ç”±ç»„ä»¶
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ LoginPage.jsx # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ RegisterPage.jsx # æ³¨å†Œé¡µé¢
â”‚   â””â”€â”€ HomePage.jsx # é¦–é¡µï¼ˆå—ä¿æŠ¤ï¼‰
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ auth.js # è®¤è¯å·¥å…·å‡½æ•°
â”œâ”€â”€ App.jsx # åº”ç”¨ä¸»ç»„ä»¶å’Œè·¯ç”±é…ç½®
â”œâ”€â”€ main.jsx # åº”ç”¨å…¥å£
â””â”€â”€ index.css # æ ·å¼æ–‡ä»¶
```

æ‰€æœ‰åŠŸèƒ½éƒ½å·²å®Œæˆï¼æ‚¨ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„ã€æ•™å­¦æ€§å¾ˆå¼ºçš„ React ç™»å½•/æ³¨å†Œç³»ç»Ÿã€‚
